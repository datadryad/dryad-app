<div class="o-admin-container">
  <div>
    <h2 class="o-heading__level2">Queue information</h2>
    <p>
      Latest refresh at <%= formatted_datetime(Time.new.utc) %><br/>
      <% if @holding_submissions %>Submissions are being held for shutdown<% else %>Normal submissions in effect<% end %><br/>
      <br/>
      <%= @queued_count %> are in queued state<br/>
      <%= @processing_count %> are currently processing<br/>
      <%= @errored_count %> errored<br/>
      <%= @day_completed_submissions %> submissions completed in the last 24 hours<br/>
    </p>
  </div>
</div>

<div class="table-wrapper c-lined-table-wrapper"  role="region" tabindex="0" aria-labelledby="queue-label">
<table class="c-lined-table">
  <thead>
	<tr>
		<th>&check;</th>
		<th class="c-lined-table__sort" <%= sort_display('resource_id') %>>
				<%= sortable_column_head sort_field: 'resource_id', title: 'Resource' %>
		</th>
		<th>
				DOI
		</th>
		<th class="c-lined-table__sort" <%= sort_display('state') %>>
				<%= sortable_column_head sort_field: 'state', title: 'State' %>
		</th>
		<th class="c-lined-table__sort" <%= sort_display('hostname') %>>
				<%= sortable_column_head sort_field: 'hostname', title: 'Hostname' %>
		</th>
		<th class="c-lined-table__sort" <%= sort_display('updated_at') %>>
				<%= sortable_column_head sort_field: 'updated_at', title: 'Updated at' %>
		</th>
	</tr>
  </thead>
  <tbody class="c-lined-table__digits">
    <% @queue_rows.each do |qr| %>
    <tr class="c-lined-table__row">
			<td><%= check_box_tag(qr.resource_id) %></td>
      <td><%= qr.resource_id %></td>
      <td><%= StashEngine::Resource.find(qr.resource_id).identifier.to_s %></td>
      <td><%= qr.state %></td>
      <td><%= qr.hostname %></td>
      <td><%= formatted_datetime(qr.updated_at) %></td>
    </tr>
    <% end %>
  </tbody>
</table>
</div>
